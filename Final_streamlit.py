# -*- coding: utf-8 -*-
"""
Created on Fri Jun  7 17:45:32 2024

@author: dharmaraj.dhanapal
"""

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
from sklearn.preprocessing import PolynomialFeatures
from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_absolute_error,mean_absolute_percentage_error, r2_score,mean_squared_error
from tqdm import tqdm
import warnings
import joblib
import streamlit as st
import os


warnings.filterwarnings('ignore')

@st.cache_data
def convert_df(df):
    # IMPORTANT: Cache the conversion to prevent computation on every rerun
    return df.to_csv().encode("utf-8")

imputed_df = pd.DataFrame({'DELL_INDUSTRY_TAXONOMY_L1': {0: 'Retail', 1: 'Retail', 2: 'Retail', 3: 'Retail', 4: 'Healthcare & Life Sciences', 5: 'Healthcare & Life Sciences', 6: 'Healthcare & Life Sciences', 7: 'Healthcare & Life Sciences', 12: 'Education', 13: 'Education', 14: 'Education', 15: 'Education', 16: 'Business, Engineering & Consumer Services', 17: 'Business, Engineering & Consumer Services', 18: 'Business, Engineering & Consumer Services', 19: 'Business, Engineering & Consumer Services', 20: 'Construction & Real Estate', 21: 'Construction & Real Estate', 22: 'Construction & Real Estate', 23: 'Construction & Real Estate', 24: 'Banking, Financial Services & Insurance', 25: 'Banking, Financial Services & Insurance', 26: 'Banking, Financial Services & Insurance', 27: 'Banking, Financial Services & Insurance', 28: 'Government', 29: 'Government', 30: 'Government', 31: 'Government', 32: 'Agriculture', 33: 'Agriculture', 34: 'Agriculture', 35: 'Web & Tech', 36: 'Web & Tech', 37: 'Web & Tech', 38: 'Web & Tech', 39: 'Manufacturing', 40: 'Manufacturing', 41: 'Manufacturing', 42: 'Manufacturing', 43: 'Energy', 44: 'Energy', 45: 'Energy', 46: 'Energy', 47: 'Telecom, Media & Entertainment', 48: 'Telecom, Media & Entertainment', 49: 'Telecom, Media & Entertainment', 50: 'Telecom, Media & Entertainment', 51: 'Transportation', 52: 'Transportation', 53: 'Transportation', 54: 'Transportation'}, 'Offer': {0: 'ProSupport', 1: 'Basic Support', 2: 'ProSupport Plus', 3: 'ProSupport Flex/One', 4: 'ProSupport', 5: 'Basic Support', 6: 'ProSupport Plus', 7: 'ProSupport Flex/One', 12: 'ProSupport', 13: 'Basic Support', 14: 'ProSupport Plus', 15: 'ProSupport Flex/One', 16: 'ProSupport', 17: 'Basic Support', 18: 'ProSupport Plus', 19: 'ProSupport Flex/One', 20: 'ProSupport', 21: 'Basic Support', 22: 'ProSupport Plus', 23: 'ProSupport Flex/One', 24: 'ProSupport', 25: 'ProSupport Plus', 26: 'Basic Support', 27: 'ProSupport Flex/One', 28: 'ProSupport', 29: 'Basic Support', 30: 'ProSupport Plus', 31: 'ProSupport Flex/One', 32: 'ProSupport', 33: 'Basic Support', 34: 'ProSupport Plus', 35: 'ProSupport', 36: 'Basic Support', 37: 'ProSupport Plus', 38: 'ProSupport Flex/One', 39: 'ProSupport', 40: 'Basic Support', 41: 'ProSupport Plus', 42: 'ProSupport Flex/One', 43: 'ProSupport', 44: 'Basic Support', 45: 'ProSupport Plus', 46: 'ProSupport Flex/One', 47: 'ProSupport', 48: 'Basic Support', 49: 'ProSupport Plus', 50: 'ProSupport Flex/One', 51: 'ProSupport', 52: 'Basic Support', 53: 'ProSupport Plus', 54: 'ProSupport Flex/One'}, 'AR': {0: 0.243397, 1: 0.319225, 2: 0.360527, 3: 0.061597, 4: 0.177862, 5: 0.260842, 6: 0.48826, 7: 0.057396, 12: 0.131939, 13: 0.477164, 14: 0.378182, 15: 0.004264, 16: 0.237979, 17: 0.25995, 18: 0.44436, 19: 0.046213, 20: 0.298629, 21: 0.199059, 22: 0.488488, 23: 0.006715, 24: 0.198203, 25: 0.35256, 26: 0.395174, 27: 0.05034, 28: 0.162274, 29: 0.216589, 30: 0.350998, 31: 0.266236, 32: 0.403492, 33: 0.131628, 34: 0.459277, 35: 0.175441, 36: 0.541942, 37: 0.245059, 38: 0.01909, 39: 0.251229, 40: 0.274191, 41: 0.395164, 42: 0.075531, 43: 0.301456, 44: 0.311355, 45: 0.357252, 46: 0.026081, 47: 0.124883, 48: 0.551139, 49: 0.27069, 50: 0.045733, 51: 0.297421, 52: 0.139271, 53: 0.297275, 54: 0.262949}, 'PRU': {0: 1032.15, 1: 1032.15, 2: 1032.15, 3: 1032.15, 4: 967.6263, 5: 967.6263, 6: 967.6263, 7: 967.6263, 12: 732.178, 13: 732.178, 14: 732.178, 15: 732.178, 16: 1093.169, 17: 1093.169, 18: 1093.169, 19: 1093.169, 20: 1098.046, 21: 1098.046, 22: 1098.046, 23: 1098.046, 24: 988.6254, 25: 988.6254, 26: 988.6254, 27: 988.6254, 28: 980.2477, 29: 980.2477, 30: 980.2477, 31: 980.2477, 32: 1108.365, 33: 1108.365, 34: 1108.365, 35: 1098.236, 36: 1098.236, 37: 1098.236, 38: 1098.236, 39: 1003.976, 40: 1003.976, 41: 1003.976, 42: 1003.976, 43: 1164.846, 44: 1164.846, 45: 1164.846, 46: 1164.846, 47: 995.4943, 48: 995.4943, 49: 995.4943, 50: 995.4943, 51: 997.4505, 52: 997.4505, 53: 997.4505, 54: 997.4505}, 'Svc_discount': {0: 0.568684, 1: 0.610812, 2: 0.60617, 3: 0.672814, 4: 0.589326, 5: 0.625838, 6: 0.619193, 7: 0.685663, 12: 0.566578, 13: 0.572118, 14: 0.594685, 15: 0.255462, 16: 0.570361, 17: 0.519374, 18: 0.567221, 19: 0.382134, 20: 0.565699, 21: 0.571692, 22: 0.47164, 23: 0.35086, 24: 0.605402, 25: 0.637084, 26: 0.648381, 27: 0.696179, 28: 0.54225, 29: 0.404779, 30: 0.509019, 31: 0.105617, 32: 0.562566, 33: 0.495134, 34: 0.586612, 35: 0.558336, 36: 0.45135, 37: 0.585385, 38: 0.271766, 39: 0.535342, 40: 0.47292, 41: 0.602064, 42: 0.428115, 43: 0.604149, 44: 0.670017, 45: 0.60593, 46: 0.425329, 47: 0.599966, 48: 0.620372, 49: 0.634085, 50: 0.578711, 51: 0.604081, 52: 0.630805, 53: 0.620859, 54: 0.562814}, 'VSP': {0: 0.1084577478523194, 1: 0.06409543537002577, 2: 0.195256184448729, 3: 0.1387937528740424, 4: 0.1089888791435901, 5: 0.06413271451932373, 6: 0.1753790759213607, 7: 0.120127045297694, 12: 0.1590050976521826, 13: 0.08364330602264357, 14: 0.2483783223818941, 15: 0.1525587593493796, 16: 0.1136286059681995, 17: 0.03604442708579967, 18: 0.1932662764363311, 19: 0.09723799262927245, 20: 0.0982631805071887, 21: 0.05826408691348714, 22: 0.2036515121576277, 23: 0.1051517233502952, 24: 0.09889385842113564, 25: 0.1982301246236795, 26: 0.06771187351443243, 27: 0.1379962301650995, 28: 0.1184437516351709, 29: 0.09954927365580953, 30: 0.1795452196104008, 31: 0.1161722740332667, 32: 0.1119840904633304, 33: 0.0416515668140191, 34: 0.2058063019568202, 35: 0.1254403041595371, 36: 0.02735172330458462, 37: 0.2126432922421624, 38: 0.119218109748598, 39: 0.1136570793572041, 40: 0.09071172365810273, 41: 0.1906895565382697, 42: 0.1156023254863658, 43: 0.1130849392195158, 44: 0.07300399314208635, 45: 0.1849869979476552, 46: 0.0616393353833139, 47: 0.1209497825293869, 48: 0.04260525829966453, 49: 0.1998213140823485, 50: 0.106291009759647, 51: 0.1121880337550698, 52: 0.06353222013109841, 53: 0.1787596638001507, 54: 0.1281066862246087}, 'DURATION': {0: 3.071310028691574, 1: 2.992608767278027, 2: 3.291979703386962, 3: 3.554455183071955, 4: 3.166093251999915, 5: 2.96582796979489, 6: 3.352715730323766, 7: 3.168365188014985, 12: 3.282522129330054, 13: 2.919603053779355, 14: 3.540605716177485, 15: 3.34975802070302, 16: 3.116866925366621, 17: 2.051081682872006, 18: 3.251400058886468, 19: 2.718111580830048, 20: 3.079203111123072, 21: 2.750964269594054, 22: 3.622628522652466, 23: 3.057976666448188, 24: 3.081763223123702, 25: 3.325028044305877, 26: 3.162850610462091, 27: 3.473663088088963, 28: 3.584529392863868, 29: 3.750110640545918, 30: 3.836793054892998, 31: 3.73189508460869, 32: 3.053869841388835, 33: 2.082912621359224, 34: 3.317127498823354, 35: 3.115830769164396, 36: 1.58196067259289, 37: 3.269820808967395, 38: 3.004497286120444, 39: 3.215167524791518, 40: 3.407988622155147, 41: 3.292257042366694, 42: 3.425228405647517, 43: 3.392124320506432, 44: 3.411716398413786, 45: 3.432053705850104, 46: 3.029621762337128, 47: 3.358231248086417, 48: 2.246518404844113, 49: 3.253277022408502, 50: 3.378168018467285, 51: 3.244563721576816, 52: 2.900671881229616, 53: 3.110561449250034, 54: 3.38770163493354}, 'SRU': {0: 31.53439, 1: 22.05449, 2: 76.78285, 3: 7.747087, 4: 21.30897, 5: 16.75394, 6: 87.28401, 7: 5.801244, 12: 17.07486, 13: 32.06885, 14: 71.49368, 15: 0.909569, 16: 29.85666, 17: 11.57297, 18: 95.51428, 19: 7.13518, 20: 35.23113, 21: 13.73255, 22: 145.3062, 23: 1.267116, 24: 22.17232, 25: 72.70858, 26: 26.97135, 27: 6.050326, 28: 26.13121, 29: 38.11723, 30: 91.89931, 31: 82.16009, 32: 52.47931, 33: 7.349195, 34: 103.747, 35: 22.69059, 36: 18.98537, 37: 50.43753, 38: 3.86907, 39: 36.75621, 40: 36.31825, 41: 83.07091, 42: 13.83358, 43: 41.8976, 44: 23.28749, 45: 80.85711, 46: 2.868285, 47: 15.10681, 48: 22.28689, 49: 49.48368, 50: 5.120026, 51: 36.02265, 52: 8.907659, 53: 54.93884, 54: 40.15695}, 'SRU By Equation': {0: 36.8474765328958, 1: 21.40249631093459, 2: 18.15987049000636, 3: -35.34887587238609, 4: 18.46032834377165, 5: 18.82076251246237, 6: 24.24862842251375, 7: -5.411254499795064, 12: 18.95780228121853, 13: 43.35297948995625, 14: 22.32064071765359, 15: 276.7948863455806, 16: 33.49816803160217, 17: 7.679358124352888, 18: 22.72763737814525, 19: 16.35467754478861, 20: 44.84846110882025, 21: 6.914406910562903, 22: 29.15152999982092, 23: 1028.845153995067, 24: 28.03852520278894, 25: 16.00243616627094, 26: 26.76453642785165, 27: -29.10331227052757, 28: 33.72534389296706, 29: 31.10646770868905, 30: 20.37949027141286, 31: 18.48183689821575, 32: 64.55339906600344, 33: 62.71261440011705, 34: 25.88110512772084, 35: 29.52088238286443, 36: 24.76672715731684, 37: 13.6908484624343, 38: 63.97781565885589, 39: 34.17399926233884, 40: 26.98804490176796, 41: 18.22409002458716, 42: 29.28394002049968, 43: 45.14532897876695, 44: 26.36454664403, 45: 19.7567655402238, 46: -10577192555475.51, 47: 19.92376376341517, 48: 29.33368351851716, 49: 12.69202175356095, 50: 52.3354067201488, 51: 41.58659558344003, 52: 12.60600111828098, 53: 9.99766849704119, 54: -39.43534539391237}, 'Equation': {0: 'Complete Linear Equation:SRU = -22.15284448786707\n + 0.0000 * 1\n + 5.0912 * AR\n + -24.2753 * DURATION\n + -0.0133 * PRU\n + 208.9447 * Svc_discount\n + 4.2587 * VSP\n + 41.9548 * AR DURATION\n + 0.0371 * AR PRU\n + -84.1207 * AR Svc_discount\n + -2.5548 * AR VSP\n + 0.0378 * DURATION PRU\n + -21.0073 * DURATION Svc_discount\n + 0.0024 * DURATION VSP\n + -0.1444 * PRU Svc_discount\n + -0.0047 * PRU VSP\n + 1.0766 * Svc_discount VSP\n', 1: 'Complete Linear Equation:SRU = 71.9351108990792\n + 0.0000 * 1\n + -34.2878 * AR\n + 72.9130 * DURATION\n + -0.0744 * PRU\n + -58.1879 * Svc_discount\n + -3380.6632 * VSP\n + 18.1070 * AR DURATION\n + 0.0381 * AR PRU\n + -20.8846 * AR Svc_discount\n + 514.0368 * AR VSP\n + -0.0087 * DURATION PRU\n + -118.4051 * DURATION Svc_discount\n + 22.9987 * DURATION VSP\n + 0.0737 * PRU Svc_discount\n + 0.9826 * PRU VSP\n + 4144.4233 * Svc_discount VSP\n', 2: 'Complete Linear Equation:SRU = 87.14104472218133\n + 0.0000 * 1\n + -37.1715 * AR\n + -20.5648 * DURATION\n + -0.0776 * PRU\n + -9.6602 * Svc_discount\n + -7.0298 * VSP\n + 18.4311 * AR DURATION\n + 0.0321 * AR PRU\n + -15.3004 * AR Svc_discount\n + 2.1453 * AR VSP\n + 0.0213 * DURATION PRU\n + -6.1266 * DURATION Svc_discount\n + 1.4801 * DURATION VSP\n + 0.0116 * PRU Svc_discount\n + 0.0006 * PRU VSP\n + 3.1619 * Svc_discount VSP\n', 3: 'Complete Linear Equation:SRU = -692.7647419600057\n + 0.0000 * 1\n + 189.5201 * AR\n + 7.8143 * DURATION\n + 0.5844 * PRU\n + 378.0905 * Svc_discount\n + 4227.8280 * VSP\n + 19.3419 * AR DURATION\n + -0.1116 * AR PRU\n + -93.4046 * AR Svc_discount\n + 514.6673 * AR VSP\n + -0.0757 * DURATION PRU\n + 126.9556 * DURATION Svc_discount\n + -238.0871 * DURATION VSP\n + -0.3024 * PRU Svc_discount\n + -1.2361 * PRU VSP\n + -3697.4798 * Svc_discount VSP\n', 4: 'Complete Linear Equation:SRU = 75.66970884083439\n + 0.0000 * 1\n + -18.9986 * AR\n + -34.6788 * DURATION\n + -0.0256 * PRU\n + 54.9103 * Svc_discount\n + -2.1360 * VSP\n + 55.8041 * AR DURATION\n + 0.0333 * AR PRU\n + -112.0891 * AR Svc_discount\n + -1.7612 * AR VSP\n + 0.0234 * DURATION PRU\n + 0.3498 * DURATION Svc_discount\n + -0.2054 * DURATION VSP\n + -0.0866 * PRU Svc_discount\n + -0.0005 * PRU VSP\n + 6.7242 * Svc_discount VSP\n', 5: 'Complete Linear Equation:SRU = 17.152116575876313\n + 0.0000 * 1\n + -41.0534 * AR\n + -2.6969 * DURATION\n + -0.0268 * PRU\n + 79.5329 * Svc_discount\n + -414.8125 * VSP\n + 35.9819 * AR DURATION\n + 0.0526 * AR PRU\n + -44.6659 * AR Svc_discount\n + -9.4960 * AR VSP\n + 0.0066 * DURATION PRU\n + -21.5981 * DURATION Svc_discount\n + 132.5291 * DURATION VSP\n + -0.0265 * PRU Svc_discount\n + 0.0045 * PRU VSP\n + 26.7453 * Svc_discount VSP\n', 6: 'Complete Linear Equation:SRU = 121.42593568867846\n + 0.0000 * 1\n + -84.7812 * AR\n + -26.8835 * DURATION\n + -0.0479 * PRU\n + -21.3820 * Svc_discount\n + -6.6112 * VSP\n + 31.9548 * AR DURATION\n + 0.0268 * AR PRU\n + -7.5440 * AR Svc_discount\n + 2.7777 * AR VSP\n + 0.0109 * DURATION PRU\n + -5.8270 * DURATION Svc_discount\n + 1.7094 * DURATION VSP\n + 0.0128 * PRU Svc_discount\n + 0.0011 * PRU VSP\n + -0.2868 * Svc_discount VSP\n', 7: 'Complete Linear Equation:SRU = 356.44379330498646\n + 0.0000 * 1\n + 239.5110 * AR\n + -172.3973 * DURATION\n + -0.1685 * PRU\n + -958.7171 * Svc_discount\n + 4387.7114 * VSP\n + -84.2152 * AR DURATION\n + -0.0114 * AR PRU\n + 127.7535 * AR Svc_discount\n + 581.2372 * AR VSP\n + 0.0634 * DURATION PRU\n + 371.1445 * DURATION Svc_discount\n + -743.1306 * DURATION VSP\n + 0.0014 * PRU Svc_discount\n + -0.2946 * PRU VSP\n + -2593.0148 * Svc_discount VSP\n', 12: 'Complete Linear Equation:SRU = 133.20204894809274\n + 0.0000 * 1\n + -22.6674 * AR\n + -23.2982 * DURATION\n + -0.0408 * PRU\n + -59.3968 * Svc_discount\n + -10.4362 * VSP\n + 42.4694 * AR DURATION\n + 0.0255 * AR PRU\n + -74.2527 * AR Svc_discount\n + 0.9854 * AR VSP\n + 0.0125 * DURATION PRU\n + -6.5828 * DURATION Svc_discount\n + 0.9084 * DURATION VSP\n + -0.0103 * PRU Svc_discount\n + 0.0015 * PRU VSP\n + 9.8868 * Svc_discount VSP\n', 13: 'Complete Linear Equation:SRU = -33.45240052147672\n + 0.0000 * 1\n + -29.1929 * AR\n + 1.7212 * DURATION\n + 0.0245 * PRU\n + 96.3396 * Svc_discount\n + 9.8363 * VSP\n + 38.3586 * AR DURATION\n + 0.0304 * AR PRU\n + -27.0728 * AR Svc_discount\n + -7.4336 * AR VSP\n + 0.0025 * DURATION PRU\n + -10.6987 * DURATION Svc_discount\n + -0.8283 * DURATION VSP\n + -0.0745 * PRU Svc_discount\n + -0.0003 * PRU VSP\n + -13.1033 * Svc_discount VSP\n', 14: 'Complete Linear Equation:SRU = 106.63334891017126\n + 0.0000 * 1\n + -62.2602 * AR\n + -26.3874 * DURATION\n + -0.0435 * PRU\n + 9.4010 * Svc_discount\n + -8.7104 * VSP\n + 31.8789 * AR DURATION\n + 0.0279 * AR PRU\n + -51.4773 * AR Svc_discount\n + 3.7794 * AR VSP\n + 0.0066 * DURATION PRU\n + -2.3920 * DURATION Svc_discount\n + 1.8191 * DURATION VSP\n + 0.0185 * PRU Svc_discount\n + 0.0016 * PRU VSP\n + 0.3019 * Svc_discount VSP\n', 15: 'Complete Linear Equation:SRU = 923.4216928694958\n + 0.0000 * 1\n + -411.3620 * AR\n + 6.7366 * DURATION\n + -0.2826 * PRU\n + -984.1103 * Svc_discount\n + -2004.6116 * VSP\n + -75.6355 * AR DURATION\n + 0.0172 * AR PRU\n + 725.1394 * AR Svc_discount\n + 2288.1079 * AR VSP\n + 0.0551 * DURATION PRU\n + -76.4852 * DURATION Svc_discount\n + -101.1715 * DURATION VSP\n + 0.1676 * PRU Svc_discount\n + -0.3419 * PRU VSP\n + 2160.5945 * Svc_discount VSP\n', 16: 'Complete Linear Equation:SRU = -15.578188995437586\n + 0.0000 * 1\n + -6.0515 * AR\n + -22.8771 * DURATION\n + -0.0035 * PRU\n + 191.6035 * Svc_discount\n + 0.4467 * VSP\n + 47.4867 * AR DURATION\n + 0.0476 * AR PRU\n + -104.0803 * AR Svc_discount\n + -1.5983 * AR VSP\n + 0.0292 * DURATION PRU\n + -16.3207 * DURATION Svc_discount\n + -0.0391 * DURATION VSP\n + -0.1406 * PRU Svc_discount\n + -0.0020 * PRU VSP\n + 2.7499 * Svc_discount VSP\n', 17: 'Complete Linear Equation:SRU = -9.72915576360306\n + 0.0000 * 1\n + -8.6256 * AR\n + -26.6147 * DURATION\n + -0.0373 * PRU\n + 64.5536 * Svc_discount\n + 1043.9966 * VSP\n + 37.2323 * AR DURATION\n + 0.0274 * AR PRU\n + -47.2024 * AR Svc_discount\n + -187.4987 * AR VSP\n + -0.0019 * DURATION PRU\n + 30.4139 * DURATION Svc_discount\n + -25.1728 * DURATION VSP\n + 0.0233 * PRU Svc_discount\n + 0.7448 * PRU VSP\n + -2372.1788 * Svc_discount VSP\n', 18: 'Complete Linear Equation:SRU = 86.20908423299451\n + 0.0000 * 1\n + -25.0098 * AR\n + -22.1949 * DURATION\n + -0.0869 * PRU\n + 2.4785 * Svc_discount\n + -6.8051 * VSP\n + 19.3559 * AR DURATION\n + 0.0362 * AR PRU\n + -47.0979 * AR Svc_discount\n + 3.1467 * AR VSP\n + 0.0221 * DURATION PRU\n + -5.8148 * DURATION Svc_discount\n + 1.3371 * DURATION VSP\n + 0.0191 * PRU Svc_discount\n + 0.0011 * PRU VSP\n + 1.6534 * Svc_discount VSP\n', 19: 'Complete Linear Equation:SRU = -513.5120569283895\n + 0.0000 * 1\n + 232.0893 * AR\n + 308.5695 * DURATION\n + 0.0110 * PRU\n + 483.3882 * Svc_discount\n + -1993.5749 * VSP\n + 50.4282 * AR DURATION\n + -0.0746 * AR PRU\n + -300.3241 * AR Svc_discount\n + -494.5710 * AR VSP\n + -0.0437 * DURATION PRU\n + -446.9890 * DURATION Svc_discount\n + 140.9057 * DURATION VSP\n + 0.3255 * PRU Svc_discount\n + -0.7155 * PRU VSP\n + 4828.0580 * Svc_discount VSP\n', 20: 'Complete Linear Equation:SRU = 8.716754677803806\n + 0.0000 * 1\n + 16.4597 * AR\n + -27.9803 * DURATION\n + -0.0272 * PRU\n + 155.7724 * Svc_discount\n + 0.9279 * VSP\n + 41.9802 * AR DURATION\n + 0.0402 * AR PRU\n + -104.6268 * AR Svc_discount\n + -1.7126 * AR VSP\n + 0.0349 * DURATION PRU\n + -11.0344 * DURATION Svc_discount\n + 0.2467 * DURATION VSP\n + -0.1188 * PRU Svc_discount\n + -0.0036 * PRU VSP\n + 2.9088 * Svc_discount VSP\n', 21: 'Complete Linear Equation:SRU = 88.30277985847488\n + 0.0000 * 1\n + -45.5178 * AR\n + 33.0269 * DURATION\n + -0.0623 * PRU\n + -70.4901 * Svc_discount\n + -2952.4249 * VSP\n + 4.6444 * AR DURATION\n + 0.0330 * AR PRU\n + 6.7806 * AR Svc_discount\n + 1082.4060 * AR VSP\n + -0.0074 * DURATION PRU\n + -61.0830 * DURATION Svc_discount\n + 159.0130 * DURATION VSP\n + 0.0587 * PRU Svc_discount\n + 1.0882 * PRU VSP\n + 2427.6639 * Svc_discount VSP\n', 22: 'Complete Linear Equation:SRU = 66.65846684257676\n + 0.0000 * 1\n + -10.9677 * AR\n + -18.7306 * DURATION\n + -0.0782 * PRU\n + 13.0301 * Svc_discount\n + -13.9573 * VSP\n + 17.6391 * AR DURATION\n + 0.0320 * AR PRU\n + -52.9543 * AR Svc_discount\n + 3.1361 * AR VSP\n + 0.0203 * DURATION PRU\n + -7.5803 * DURATION Svc_discount\n + 4.2543 * DURATION VSP\n + 0.0218 * PRU Svc_discount\n + -0.0033 * PRU VSP\n + 3.7006 * Svc_discount VSP\n', 23: 'Complete Linear Equation:SRU = 3123.299021047837\n + 0.0000 * 1\n + -0.0000 * AR\n + 0.0012 * DURATION\n + -0.4219 * PRU\n + -309.4562 * Svc_discount\n + -4637.6003 * VSP\n + 0.0012 * AR DURATION\n + -0.4219 * AR PRU\n + -309.4562 * AR Svc_discount\n + -4637.6003 * AR VSP\n + 0.7659 * DURATION PRU\n + -928.3681 * DURATION Svc_discount\n + -13912.8010 * DURATION VSP\n + -3.5081 * PRU Svc_discount\n + 5.3636 * PRU VSP\n + 70540.5929 * Svc_discount VSP\n', 24: 'Complete Linear Equation:SRU = 21.626653958865447\n + 0.0000 * 1\n + -10.1240 * AR\n + -42.8319 * DURATION\n + -0.0304 * PRU\n + 214.6994 * Svc_discount\n + -1.9708 * VSP\n + 43.5674 * AR DURATION\n + 0.0533 * AR PRU\n + -102.4649 * AR Svc_discount\n + -1.6414 * AR VSP\n + 0.0427 * DURATION PRU\n + -3.3495 * DURATION Svc_discount\n + 0.3132 * DURATION VSP\n + -0.1808 * PRU Svc_discount\n + -0.0026 * PRU VSP\n + 6.7761 * Svc_discount VSP\n', 25: 'Complete Linear Equation:SRU = 87.49344749634717\n + 0.0000 * 1\n + -35.6103 * AR\n + -25.8258 * DURATION\n + -0.0754 * PRU\n + 0.0643 * Svc_discount\n + 0.1092 * VSP\n + 17.6602 * AR DURATION\n + 0.0383 * AR PRU\n + -26.3737 * AR Svc_discount\n + 1.7381 * AR VSP\n + 0.0236 * DURATION PRU\n + 0.0190 * DURATION Svc_discount\n + -0.1907 * DURATION VSP\n + -0.0074 * PRU Svc_discount\n + 0.0013 * PRU VSP\n + -0.9761 * Svc_discount VSP\n', 26: 'Complete Linear Equation:SRU = 61.65996025550544\n + 0.0000 * 1\n + -78.2077 * AR\n + 9.6459 * DURATION\n + -0.0731 * PRU\n + 14.0464 * Svc_discount\n + -948.8543 * VSP\n + -1.9600 * AR DURATION\n + 0.0704 * AR PRU\n + 7.7076 * AR Svc_discount\n + 1136.2190 * AR VSP\n + 0.0387 * DURATION PRU\n + -74.8686 * DURATION Svc_discount\n + 3.0109 * DURATION VSP\n + 0.0136 * PRU Svc_discount\n + -0.6890 * PRU VSP\n + 2388.0501 * Svc_discount VSP\n', 27: 'Complete Linear Equation:SRU = 2352.458976983391\n + 0.0000 * 1\n + -191.5616 * AR\n + -504.6776 * DURATION\n + -0.9405 * PRU\n + -2906.9841 * Svc_discount\n + 1112.9447 * VSP\n + 80.2130 * AR DURATION\n + -0.0871 * AR PRU\n + 343.9067 * AR Svc_discount\n + -788.3267 * AR VSP\n + 0.1713 * DURATION PRU\n + 354.3335 * DURATION Svc_discount\n + 90.6564 * DURATION VSP\n + 0.9586 * PRU Svc_discount\n + -1.3959 * PRU VSP\n + 2153.1491 * Svc_discount VSP\n', 28: 'Complete Linear Equation:SRU = 271.05868394930155\n + 0.0000 * 1\n + -85.1617 * AR\n + -41.2110 * DURATION\n + -0.0631 * PRU\n + -207.7987 * Svc_discount\n + -17.2996 * VSP\n + 47.5666 * AR DURATION\n + 0.0350 * AR PRU\n + -48.5309 * AR Svc_discount\n + 2.9112 * AR VSP\n + 0.0108 * DURATION PRU\n + 15.1094 * DURATION Svc_discount\n + 1.4913 * DURATION VSP\n + 0.0048 * PRU Svc_discount\n + 0.0029 * PRU VSP\n + 13.8811 * Svc_discount VSP\n', 29: 'Complete Linear Equation:SRU = -36.90016380897504\n + 0.0000 * 1\n + 0.2964 * AR\n + 4.6532 * DURATION\n + 0.0543 * PRU\n + -0.3256 * Svc_discount\n + -15.5528 * VSP\n + 53.9411 * AR DURATION\n + 0.0011 * AR PRU\n + -67.8902 * AR Svc_discount\n + -10.3694 * AR VSP\n + -0.0113 * DURATION PRU\n + 9.1532 * DURATION Svc_discount\n + -0.6691 * DURATION VSP\n + -0.0308 * PRU Svc_discount\n + 0.0041 * PRU VSP\n + 23.5429 * Svc_discount VSP\n', 30: 'Complete Linear Equation:SRU = 235.3351015830958\n + 0.0000 * 1\n + -137.6786 * AR\n + -49.2645 * DURATION\n + -0.0626 * PRU\n + -132.9037 * Svc_discount\n + -9.9474 * VSP\n + 44.3911 * AR DURATION\n + 0.0268 * AR PRU\n + 8.7569 * AR Svc_discount\n + 3.8932 * AR VSP\n + 0.0062 * DURATION PRU\n + 17.3618 * DURATION Svc_discount\n + 2.0484 * DURATION VSP\n + 0.0469 * PRU Svc_discount\n + 0.0018 * PRU VSP\n + 0.4967 * Svc_discount VSP\n', 31: 'Complete Linear Equation:SRU = -35.4125998518742\n + 0.0000 * 1\n + 18.4698 * AR\n + 14.6749 * DURATION\n + 0.0084 * PRU\n + 30.4433 * Svc_discount\n + -32.6503 * VSP\n + 12.0303 * AR DURATION\n + -0.0004 * AR PRU\n + 3.6946 * AR Svc_discount\n + -90.1525 * AR VSP\n + -0.0015 * DURATION PRU\n + -19.4848 * DURATION Svc_discount\n + -20.2433 * DURATION VSP\n + -0.0024 * PRU Svc_discount\n + -0.0370 * PRU VSP\n + 305.4612 * Svc_discount VSP\n', 32: 'Complete Linear Equation:SRU = -191.090743806063\n + 0.0000 * 1\n + 91.7041 * AR\n + -29.0857 * DURATION\n + -0.0076 * PRU\n + 685.0058 * Svc_discount\n + 7.5308 * VSP\n + 49.5068 * AR DURATION\n + 0.0149 * AR PRU\n + -238.8186 * AR Svc_discount\n + -0.6537 * AR VSP\n + 0.0700 * DURATION PRU\n + -85.8633 * DURATION Svc_discount\n + -2.2149 * DURATION VSP\n + -0.2755 * PRU Svc_discount\n + -0.0097 * PRU VSP\n + 11.4533 * Svc_discount VSP\n', 33: 'Complete Linear Equation:SRU = -41.02126243864086\n + 0.0000 * 1\n + 89.4545 * AR\n + -139.6807 * DURATION\n + 0.0054 * PRU\n + 25.1973 * Svc_discount\n + 5002.8110 * VSP\n + -50.2262 * AR DURATION\n + 0.0016 * AR PRU\n + 32.2079 * AR Svc_discount\n + -926.6549 * AR VSP\n + 0.0421 * DURATION PRU\n + 230.4031 * DURATION Svc_discount\n + 888.6425 * DURATION VSP\n + -0.0274 * PRU Svc_discount\n + -0.6865 * PRU VSP\n + -9335.9882 * Svc_discount VSP\n', 34: 'Complete Linear Equation:SRU = 25.4529292891053\n + 0.0000 * 1\n + 3.2621 * AR\n + -0.9904 * DURATION\n + -0.1032 * PRU\n + 72.7261 * Svc_discount\n + -7.0363 * VSP\n + 8.7958 * AR DURATION\n + 0.0385 * AR PRU\n + -36.8612 * AR Svc_discount\n + 2.2300 * AR VSP\n + 0.0267 * DURATION PRU\n + -34.7804 * DURATION Svc_discount\n + 0.3322 * DURATION VSP\n + 0.0311 * PRU Svc_discount\n + 0.0016 * PRU VSP\n + 7.9631 * Svc_discount VSP\n', 35: 'Complete Linear Equation:SRU = 6.370413110097388\n + 0.0000 * 1\n + 3.9419 * AR\n + -31.4640 * DURATION\n + -0.0197 * PRU\n + 179.3073 * Svc_discount\n + -0.0590 * VSP\n + 47.8277 * AR DURATION\n + 0.0448 * AR PRU\n + -115.1403 * AR Svc_discount\n + -1.1552 * AR VSP\n + 0.0364 * DURATION PRU\n + -12.2578 * DURATION Svc_discount\n + 0.1395 * DURATION VSP\n + -0.1380 * PRU Svc_discount\n + -0.0023 * PRU VSP\n + 2.8107 * Svc_discount VSP\n', 36: 'Complete Linear Equation:SRU = 66.53456196295309\n + 0.0000 * 1\n + -39.9772 * AR\n + 48.7992 * DURATION\n + -0.0606 * PRU\n + -47.6840 * Svc_discount\n + -2701.7603 * VSP\n + 15.2977 * AR DURATION\n + 0.0412 * AR PRU\n + -15.8810 * AR Svc_discount\n + 607.6547 * AR VSP\n + 0.0145 * DURATION PRU\n + -130.1848 * DURATION Svc_discount\n + 33.3654 * DURATION VSP\n + 0.0509 * PRU Svc_discount\n + 0.0654 * PRU VSP\n + 4944.7576 * Svc_discount VSP\n', 37: 'Complete Linear Equation:SRU = 75.45451279461415\n + 0.0000 * 1\n + -15.5292 * AR\n + -16.2043 * DURATION\n + -0.0928 * PRU\n + 22.1014 * Svc_discount\n + -5.3443 * VSP\n + 18.5949 * AR DURATION\n + 0.0327 * AR PRU\n + -50.4351 * AR Svc_discount\n + 2.6279 * AR VSP\n + 0.0226 * DURATION PRU\n + -16.6452 * DURATION Svc_discount\n + 0.7701 * DURATION VSP\n + 0.0284 * PRU Svc_discount\n + 0.0015 * PRU VSP\n + 1.7246 * Svc_discount VSP\n', 38: 'Complete Linear Equation:SRU = 1250.1604328312383\n + 0.0000 * 1\n + -693.3407 * AR\n + -137.1148 * DURATION\n + -0.1517 * PRU\n + -1678.8550 * Svc_discount\n + -929.0718 * VSP\n + 43.2872 * AR DURATION\n + 0.0359 * AR PRU\n + 231.9751 * AR Svc_discount\n + 3992.5238 * AR VSP\n + -0.0839 * DURATION PRU\n + 362.3035 * DURATION Svc_discount\n + 252.0538 * DURATION VSP\n + 0.5941 * PRU Svc_discount\n + -1.8426 * PRU VSP\n + -2662.1074 * Svc_discount VSP\n', 39: 'Complete Linear Equation:SRU = -37.85395848660457\n + 0.0000 * 1\n + -4.8233 * AR\n + -30.1526 * DURATION\n + 0.0723 * PRU\n + 126.5557 * Svc_discount\n + 7.4528 * VSP\n + 58.1074 * AR DURATION\n + 0.0362 * AR PRU\n + -137.1921 * AR Svc_discount\n + -3.0816 * AR VSP\n + 0.0091 * DURATION PRU\n + 27.9682 * DURATION Svc_discount\n + -0.5419 * DURATION VSP\n + -0.1587 * PRU Svc_discount\n + -0.0065 * PRU VSP\n + 0.9628 * Svc_discount VSP\n', 40: 'Complete Linear Equation:SRU = -3.766548663994641\n + 0.0000 * 1\n + -17.3915 * AR\n + 41.5616 * DURATION\n + -0.0145 * PRU\n + 61.6613 * Svc_discount\n + -1926.1201 * VSP\n + 29.9632 * AR DURATION\n + 0.0310 * AR PRU\n + -31.4769 * AR Svc_discount\n + 0.9925 * AR VSP\n + 0.0114 * DURATION PRU\n + -102.5387 * DURATION Svc_discount\n + -29.7014 * DURATION VSP\n + -0.0278 * PRU Svc_discount\n + 0.1561 * PRU VSP\n + 3634.5306 * Svc_discount VSP\n', 41: 'Complete Linear Equation:SRU = 109.10806931114317\n + 0.0000 * 1\n + -32.2481 * AR\n + -35.9209 * DURATION\n + -0.0431 * PRU\n + -94.7562 * Svc_discount\n + 2.5443 * VSP\n + 22.5492 * AR DURATION\n + 0.0239 * AR PRU\n + -28.5941 * AR Svc_discount\n + -1.3469 * AR VSP\n + 0.0141 * DURATION PRU\n + 29.0449 * DURATION Svc_discount\n + 0.8679 * DURATION VSP\n + 0.0061 * PRU Svc_discount\n + -0.0007 * PRU VSP\n + -2.5007 * Svc_discount VSP\n', 42: 'Complete Linear Equation:SRU = -80.37729165649105\n + 0.0000 * 1\n + 90.2143 * AR\n + -43.9792 * DURATION\n + 0.1794 * PRU\n + 40.5050 * Svc_discount\n + 314.8039 * VSP\n + -52.8197 * AR DURATION\n + -0.1140 * AR PRU\n + 239.0049 * AR Svc_discount\n + 1376.8081 * AR VSP\n + 0.0942 * DURATION PRU\n + -35.0520 * DURATION Svc_discount\n + 60.4591 * DURATION VSP\n + -0.3048 * PRU Svc_discount\n + -2.0296 * PRU VSP\n + 1865.1842 * Svc_discount VSP\n', 43: 'Complete Linear Equation:SRU = 21.20055723780888\n + 0.0000 * 1\n + -23.1402 * AR\n + -59.2118 * DURATION\n + 0.0469 * PRU\n + 160.9520 * Svc_discount\n + 3.6768 * VSP\n + 61.0709 * AR DURATION\n + 0.0132 * AR PRU\n + -85.8411 * AR Svc_discount\n + -3.9373 * AR VSP\n + 0.0360 * DURATION PRU\n + 13.1529 * DURATION Svc_discount\n + 0.2391 * DURATION VSP\n + -0.2002 * PRU Svc_discount\n + -0.0058 * PRU VSP\n + 5.4356 * Svc_discount VSP\n', 44: 'Complete Linear Equation:SRU = 58.72378409425586\n + 0.0000 * 1\n + -24.6316 * AR\n + 9.0414 * DURATION\n + -0.0481 * PRU\n + -54.1949 * Svc_discount\n + -1656.7069 * VSP\n + 30.8478 * AR DURATION\n + 0.0127 * AR PRU\n + 26.4057 * AR Svc_discount\n + -251.2832 * AR VSP\n + 0.0127 * DURATION PRU\n + -85.1733 * DURATION Svc_discount\n + 66.1952 * DURATION VSP\n + 0.0364 * PRU Svc_discount\n + 0.7918 * PRU VSP\n + 3121.7310 * Svc_discount VSP\n', 45: 'Complete Linear Equation:SRU = 141.56876372817993\n + 0.0000 * 1\n + -44.1285 * AR\n + -39.0483 * DURATION\n + -0.1054 * PRU\n + -43.0779 * Svc_discount\n + -7.9265 * VSP\n + 19.2126 * AR DURATION\n + 0.0436 * AR PRU\n + -31.0194 * AR Svc_discount\n + 0.1116 * AR VSP\n + 0.0279 * DURATION PRU\n + 10.0264 * DURATION Svc_discount\n + 1.8506 * DURATION VSP\n + 0.0128 * PRU Svc_discount\n + 0.0019 * PRU VSP\n + 3.1833 * Svc_discount VSP\n', 46: 'Complete Linear Equation:SRU = 2525191535.0474644\n + 0.0000 * 1\n + -19852026907.5340 * AR\n + -832198058.0044 * DURATION\n + 919628109353.2621 * PRU\n + -1181099807.3225 * Svc_discount\n + -75823831.1356 * VSP\n + 6607809401.9326 * AR DURATION\n + -0.5442 * AR PRU\n + 6047.3512 * AR Svc_discount\n + 228382030.2297 * AR VSP\n + -306542703117.0699 * DURATION PRU\n + 393698428.1400 * DURATION Svc_discount\n + -50852868.2985 * DURATION VSP\n + -1.7953 * PRU Svc_discount\n + -3.8925 * PRU VSP\n + 8016.0512 * Svc_discount VSP\n', 47: 'Complete Linear Equation:SRU = 8.005636954477154\n + 0.0000 * 1\n + 3.0999 * AR\n + -25.7740 * DURATION\n + -0.0452 * PRU\n + 201.2551 * Svc_discount\n + 0.5495 * VSP\n + 41.9491 * AR DURATION\n + 0.0711 * AR PRU\n + -143.0860 * AR Svc_discount\n + -1.3942 * AR VSP\n + 0.0341 * DURATION PRU\n + -16.5127 * DURATION Svc_discount\n + 0.2967 * DURATION VSP\n + -0.1238 * PRU Svc_discount\n + -0.0039 * PRU VSP\n + 3.5735 * Svc_discount VSP\n', 48: 'Complete Linear Equation:SRU = -21.868109308408904\n + 0.0000 * 1\n + -28.6893 * AR\n + -40.2354 * DURATION\n + -0.0498 * PRU\n + 130.2097 * Svc_discount\n + 1761.9115 * VSP\n + 21.2785 * AR DURATION\n + 0.0449 * AR PRU\n + -47.6342 * AR Svc_discount\n + 429.7828 * AR VSP\n + -0.0030 * DURATION PRU\n + 58.8224 * DURATION Svc_discount\n + -70.2494 * DURATION VSP\n + 0.0036 * PRU Svc_discount\n + 1.0362 * PRU VSP\n + -4103.0605 * Svc_discount VSP\n', 49: 'Complete Linear Equation:SRU = 82.07952350813717\n + 0.0000 * 1\n + -14.1940 * AR\n + -20.4416 * DURATION\n + -0.0866 * PRU\n + -10.5097 * Svc_discount\n + -4.1121 * VSP\n + 14.5286 * AR DURATION\n + 0.0332 * AR PRU\n + -35.2543 * AR Svc_discount\n + 0.0566 * AR VSP\n + 0.0232 * DURATION PRU\n + -4.6554 * DURATION Svc_discount\n + 1.2459 * DURATION VSP\n + 0.0191 * PRU Svc_discount\n + 0.0007 * PRU VSP\n + 2.5145 * Svc_discount VSP\n', 50: 'Complete Linear Equation:SRU = 559.0288309288871\n + 0.0000 * 1\n + -170.9874 * AR\n + -111.4656 * DURATION\n + 0.3029 * PRU\n + -1079.1917 * Svc_discount\n + -887.7779 * VSP\n + -74.2690 * AR DURATION\n + 0.0634 * AR PRU\n + 534.6610 * AR Svc_discount\n + 813.8260 * AR VSP\n + -0.0185 * DURATION PRU\n + 305.9650 * DURATION Svc_discount\n + 27.5445 * DURATION VSP\n + -0.4436 * PRU Svc_discount\n + -0.4715 * PRU VSP\n + 736.4777 * Svc_discount VSP\n', 51: 'Complete Linear Equation:SRU = -74.7527697129157\n + 0.0000 * 1\n + 33.3727 * AR\n + -13.3861 * DURATION\n + 0.0235 * PRU\n + 248.5122 * Svc_discount\n + 1.9136 * VSP\n + 40.9427 * AR DURATION\n + 0.0153 * AR PRU\n + -92.3587 * AR Svc_discount\n + -2.2413 * AR VSP\n + 0.0306 * DURATION PRU\n + -31.6817 * DURATION Svc_discount\n + -0.1801 * DURATION VSP\n + -0.1462 * PRU Svc_discount\n + -0.0032 * PRU VSP\n + 3.6174 * Svc_discount VSP\n', 52: 'Complete Linear Equation:SRU = 15.695292073156097\n + 0.0000 * 1\n + -32.7611 * AR\n + 10.9312 * DURATION\n + -0.0490 * PRU\n + 45.2238 * Svc_discount\n + -642.7168 * VSP\n + 4.0079 * AR DURATION\n + 0.0418 * AR PRU\n + -26.6295 * AR Svc_discount\n + 873.1445 * AR VSP\n + 0.0083 * DURATION PRU\n + -39.5512 * DURATION Svc_discount\n + 19.3680 * DURATION VSP\n + 0.0229 * PRU Svc_discount\n + 0.4557 * PRU VSP\n + 489.7189 * Svc_discount VSP\n', 53: 'Complete Linear Equation:SRU = 76.48953793032182\n + 0.0000 * 1\n + -13.4834 * AR\n + -27.6882 * DURATION\n + -0.0626 * PRU\n + -18.9449 * Svc_discount\n + 46.1705 * VSP\n + 20.8486 * AR DURATION\n + 0.0202 * AR PRU\n + -27.2027 * AR Svc_discount\n + -47.6182 * AR VSP\n + 0.0210 * DURATION PRU\n + 0.1207 * DURATION Svc_discount\n + 2.3023 * DURATION VSP\n + 0.0097 * PRU Svc_discount\n + -0.0027 * PRU VSP\n + -2.1012 * Svc_discount VSP\n', 54: 'Complete Linear Equation:SRU = -864.8909989398147\n + 0.0000 * 1\n + -36.1460 * AR\n + 163.3430 * DURATION\n + 0.5943 * PRU\n + 454.4679 * Svc_discount\n + 984.4878 * VSP\n + 25.5644 * AR DURATION\n + -0.1482 * AR PRU\n + 251.9845 * AR Svc_discount\n + 978.7375 * AR VSP\n + -0.0670 * DURATION PRU\n + -160.9807 * DURATION Svc_discount\n + 179.1293 * DURATION VSP\n + -0.0794 * PRU Svc_discount\n + -1.3905 * PRU VSP\n + -963.5730 * Svc_discount VSP\n'}, 'MSE': {0: 1422.903910379486, 1: 145.3543270877379, 2: 238.2578955861171, 3: 5830.464361640944, 4: 1237.677244687859, 5: 448.6203417201745, 6: 292.6352845395313, 7: 3933.730593326978, 12: 1044.555380351628, 13: 593.8001873589982, 14: 445.9802942706018, 15: 4817.689766804002, 16: 1307.102467999953, 17: 154.7935154050709, 18: 257.732067242785, 19: 9888.042755800494, 20: 1474.002236843217, 21: 148.440387724179, 22: 273.0118939167139, 23: 3571.338768830006, 24: 1386.260604949797, 25: 156.4776674828142, 26: 81.2008994696604, 27: 3006.04608339105, 28: 1213.552831270246, 29: 1372.435933687398, 30: 902.4676170387703, 31: 163.4930031258992, 32: 1325.277852274547, 33: 73.86341216563754, 34: 1003.358745834285, 35: 1312.596244430004, 36: 92.01023292405065, 37: 192.8581455670409, 38: 5466.00734692342, 39: 2806.98489689709, 40: 315.0716129989193, 41: 295.1181445642395, 42: 6066.912725567226, 43: 1457.513124988368, 44: 374.6182321797948, 45: 195.5715741387077, 46: 573.900053166812, 47: 1216.436900014084, 48: 109.4828405654306, 49: 181.189215896824, 50: 1361.742753477602, 51: 1384.152809194224, 52: 55.76023967695316, 53: 121.9742092032393, 54: 1441.052130974996}, 'MAE': {0: 27.49839692706541, 1: 5.775867537010674, 2: 9.57630468931731, 3: 52.58027896815809, 4: 26.1376850562246, 5: 12.83367612988651, 6: 11.39165001053411, 7: 40.99351705485756, 12: 22.41911041910911, 13: 15.37976477623553, 14: 13.95488350159166, 15: 43.7416586161827, 16: 26.26550512597918, 17: 5.900101922635226, 18: 9.217112490671807, 19: 60.9225756236459, 20: 27.6942462214381, 21: 4.677618323270452, 22: 9.227443838611954, 23: 40.98918021262919, 24: 28.52106997377561, 25: 7.924937940823464, 26: 4.268158919615352, 27: 41.70974083552806, 28: 24.5608304161124, 29: 24.97219192174963, 30: 18.81548682981234, 31: 7.940417488636294, 32: 27.6025627182199, 33: 4.808003077996047, 34: 14.45864968100151, 35: 27.24863898639825, 36: 5.329307867491703, 37: 9.624579018239888, 38: 52.94677967289373, 39: 34.07168846406893, 40: 8.055702230646762, 41: 9.61277240818458, 42: 48.4521597561046, 43: 29.99887375478458, 44: 8.179386872159622, 45: 8.250638260778311, 46: 14.58395341505163, 47: 26.70969866378767, 48: 5.193008433848944, 49: 8.30653916258476, 50: 26.69804730909497, 51: 26.48848046630967, 52: 3.489972685582412, 53: 7.562727683528583, 54: 28.12013697317192}, 'R2 Score': {0: 0.5921054789214353, 1: 0.9026374545021285, 2: 0.6762641672069977, 3: 0.3020734244487133, 4: 0.5599468551413807, 5: 0.7790589595487617, 6: 0.8096610856042121, 7: 0.2957491309084683, 12: 0.6210788824285125, 13: 0.7922658057061381, 14: 0.8444809331659673, 15: 0.2087933757835272, 16: 0.6572035830290777, 17: 0.9079959835637919, 18: 0.7126425183968679, 19: 0.3411655906718954, 20: 0.5772119780779078, 21: 0.9060351792544473, 22: 0.7376067467360989, 23: 0.6424521632532132, 24: 0.5313058428839339, 25: 0.7081393435866523, 26: 0.9381896791298088, 27: 0.3511966250736083, 28: 0.6425969923371853, 29: 0.7689423481330255, 30: 0.797895705652828, 31: 0.4659786378608853, 32: 0.6999018202194323, 33: 0.9509319097121811, 34: 0.4279723645894675, 35: 0.6785833280608295, 36: 0.9429454562192311, 37: 0.7605732652745585, 38: 0.5355205210187564, 39: 0.4047617150039869, 40: 0.8019499616835353, 41: 0.5645201973504461, 42: 0.2908277680276987, 43: 0.615089862359756, 44: 0.8050626028047616, 45: 0.7540100423669249, 46: 0.7204577970064336, 47: 0.6493464828624766, 48: 0.9260670144182187, 49: 0.7616211622351691, 50: 0.4812890823122978, 51: 0.4910822526503095, 52: 0.9526304535450633, 53: 0.7418948815877455, 54: 0.5909745424230286}})

uploaded_file = st.file_uploader("Choose a CSV file",type='csv',accept_multiple_files=False)

if uploaded_file is not None:
    try:
        df = pd.read_csv(uploaded_file)
        np.random.seed(42)
        
        column_names = 'DELL_INDUSTRY_TAXONOMY_L1'
        segment_col = 'Offer'
        segment_col_ = 'ACCOUNT_SEGMENT'
        column_name_unique = imputed_df[column_names].unique().tolist()
        
        equation_column_name = ['Revn','New_Revn','Delta','Actual DURATION','New DURATION','Actual AR','New AR','Actual VSP','New VSP','Actual Svc_discount','New Svc_discount','Actual PRU','New PRU','Equation']
        
        equation_df = pd.DataFrame(columns = equation_column_name)
        
        df_list = []
        temp_column_names_ind = ['SELECT']
        temp_column_names_ind += column_name_unique
        option = st.selectbox('Select the industry label',(temp_column_names_ind))
        
        if option != 'SELECT':
            temp_column_names_acc = ['SELECT']
            indus_df = df[df[column_names] == option]
            temp_column_names_acc += indus_df[segment_col_].unique().tolist()
            option_acc = st.selectbox('Select the Account Segment',(temp_column_names_acc))
            
            if option_acc != 'SELECT':
                
                temp_column_names_off = ['SELECT']
                indus_df = df[df[segment_col_] == option_acc]
                temp_column_names_off += indus_df[segment_col].unique().tolist()
                try:
                    temp_column_names_off.remove('ProSupport Flex/One')
                except:
                    pass
                option_off = st.selectbox('Select the Offer',(temp_column_names_off))
                
                if option_off != 'SELECT':
                    st.header('Max Benchmark Analysis Table')
                    st.dataframe(imputed_df[imputed_df[column_names]==option])
                    
                    account_seg = option_off.replace('/',' ')
                    seg = option_acc.replace('/',' ')
                    account_seg = account_seg.replace(' ','_')
                    seg = seg.replace(' ','_')
                    ind = option.replace(' ','_')
                    
                    with open(f'Model_segement/{ind}_{seg}_{account_seg}_model.pkl','rb') as f:
                        model = joblib.load(f)
                        f.close()
                    with open(f'Model_segement/{ind}_{seg}_{account_seg}_poly.pkl','rb') as f:
                        poly = joblib.load(f)
                        f.close()
                    
                    new_duration = st.number_input('Enter the New Duration Value')
                    new_svc_discount = st.number_input('Enter the New SVC Discount Value')
                    new_pru = st.number_input('Enter the New PRU Value')
                    new_ar = st.number_input('Enter the New AR Value')
                    new_vsp= st.number_input('Enter the New VSP Value')
                    
                    if st.button('Submit'):
                        X = np.array([[new_ar,new_duration,new_pru,new_svc_discount,new_vsp]])
                        X = poly.transform(X)
                        Y = model.predict(X)
                        
                        st.subheader(f'Predicted SRU is {Y[0]}')
    except Exception as e:
        print(e)
        st.warning('Please upload a valid file', icon="⚠️")
                        